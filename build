#!/bin/bash
set -e
echo "building compiler..."
adria $@ --no-application --no-cache --no-blanks --platform node --no-map --out compiled/ngadria.js main.adria
echo "recompiling compiler with compiler..."
./ngadria $@ --no-application --no-cache --no-blanks --platform node --no-map --out compiled/ngadria.js main.adria
md5sum compiled/ngadria.js
echo "ok. again..."
./ngadria $@ --no-application --no-cache --no-blanks --platform node --no-map --out compiled/ngadria.js main.adria
md5sum compiled/ngadria.js
echo "done."
head -n22 main.adria > ef38u4985uijf.tmp
cat compiled/ngadria.js >> ef38u4985uijf.tmp
mv ef38u4985uijf.tmp compiled/ngadria.js